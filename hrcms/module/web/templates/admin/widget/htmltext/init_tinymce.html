{% comment %}
<script type="text/javascript" src="/static/lib/tinymce/3.4/tiny_mce.js"></script>
<script type="text/javascript" src="/static/lib/webcms/js/forms.js"></script>

<script type="text/javascript">
tinyMCE.init(TINYMCE_ADVANCED_OPTIONS);

(function($) {
	contentblock_init_handlers.push(function(){
		$('.order-machine textarea[class=item-richtext], #frontend_editor textarea[class=item-richtext]').each(function(){
			feincms_richtext_add_tinymce($(this));
		});
	});
	contentblock_move_handlers.poorify.push(function(item) {
		item.find('textarea[class=item-richtext]').each(feincms_richtext_remove_tinymce);
	});
	contentblock_move_handlers.richify.push(function(item) {
		item.find('textarea[class=item-richtext]').each(feincms_richtext_add_tinymce);
	});
})(jQuery);

var tinymce_added = {};

function feincms_richtext_remove_tinymce(field) {
	var id = field ? field.attr('id') : this.id;
	if(tinymce_added[id]) {
		tinyMCE.execCommand('mceRemoveControl', false, id);
		tinymce_added[id] = false;
	}
}

function feincms_richtext_add_tinymce(field) {
	var id = field ? field.attr('id') : this.id;
	if(!tinymce_added[id]) {
		tinyMCE.execCommand('mceAddControl', false, id);
		tinymce_added[id] = true;
	}
}
</script>
{% endcomment %}
