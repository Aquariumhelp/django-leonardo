{% extends "widget/base.html" %}

{% load i18n %}
{% load feincms_tags %}
{% load thumbnail %}
{% load satchmo_currency %}

{% block content %}
{% with widget.offer as object %}

{% if widget.output == 'summary' %}

{% if widget.data == 'core' or widget.data == 'all' %}
{% if widget.data == 'all' %}
<h2>{% trans "Core features" %}</h2>
{% endif %}
<dl>
{% for feature in widget.offer.offerfeature_set.all %}
{% if not feature.supplemental %}
<dt>{{ feature.feature }}</dt>
<dd>{{ feature.feature.translation.summary|safe }}</dd>
{% endif %}
{% endfor %}
</dl>
{% endif %}

{% if widget.data == 'supplement' or widget.data == 'all' %}
{% if object.get_supp_price_sale > 0 or object.get_supp_price_rent > 0 %}
{% if widget.data == 'all' %}
<h2>{% trans "Recommended features" %}</h2>
{% endif %}
<dl>
{% for feature in widget.offer.offerfeature_set.all %}
{% if feature.supplemental %}
<dt>{{ feature.feature }}</dt>
<dd>{{ feature.feature.translation.summary|safe }}</dd>
{% endif %}
{% endfor %}
</dl>
{% endif %}
{% endif %}

{% if widget.data == 'work' or widget.data == 'all' %}
{% if widget.data == 'all' %}
<h2>{% trans "Work on project" %}</h2>
{% endif %}
<dl>
{% for feature in widget.offer.offerwork_set.all %}
<dt>{{ feature.feature }}</dt>
<dd>{{ feature.feature.translation.summary|safe }}</dd>
{% endfor %}
</dl>
{% endif %}

{% else %}

{% if widget.data == 'core' or widget.data == 'all' %}
{% if widget.data == 'all' %}
<h2>{% trans "Core features" %}</h2>
{% endif %}
<table style="width:100%;">
	<thead>
		<tr>
			<th style="width:80%;">{% trans "Service feature" %}</th>
			<th class="a-right">{% trans "Price per feature" %}</th>
		</tr>
	</thead>
	<tbody>
		{% for feature in object.offerfeature_set.all %}
		{% if not feature.supplemental %}
		<tr>
			<td>{{ feature.feature }}</td>
			<td class="a-right">{{ feature.get_price|currency }} {% if feature.sale_type != 'sale' %}/ měs.{% endif %}</td>
		</tr>
		{% endif %}
		{% endfor %}
	</tbody>
</table>
<table style="width:100%;">
	<tbody>
		{% if object.get_core_price_sale > 0 %}
		<tr>
			<td style="width:80%;" class="a-right">{% trans "Total price" %}:</td>
			<td class="a-right">{{ object.get_core_price_sale|currency }}</td>
		</tr>
		{% endif %}
		{% if object.get_core_price_rent > 0 %}
		<tr>
			<td class="a-right">{% trans "Total annual price" %}:</td>
			<td class="a-right">{{ object.get_core_price_rent|currency }} / měs.</td>
		</tr>
		{% endif %}
	</tbody>
</table>
{% endif %}

{% if widget.data == 'supplement' or widget.data == 'all' %}
{% if object.get_supp_price_sale > 0 or object.get_supp_price_rent > 0 %}
{% if widget.data == 'all' %}
<h2>{% trans "Recommended features" %}</h2>
{% endif %}
<table style="width:100%;">
	<thead>
		<tr>
			<th style="width:80%;">{% trans "Service feature" %}</th>
			<th class="a-right">{% trans "Price" %}</th>
		</tr>
	</thead>
	<tbody>
		{% for feature in object.offerfeature_set.all %}
		{% if feature.supplemental %}
		<tr>
			<td>{{ feature.feature }}</td>
			<td class="a-right">{{ feature.get_price|currency }} {% if feature.sale_type != 'sale' %}/ měs.{% endif %}</td>
		</tr>
		{% endif %}
		{% endfor %}
	</tbody>
</table>
<table style="width:100%;">
	<tbody>
		{% if object.get_supp_price_sale > 0 %}
		<tr>
			<td style="width:80%;" class="a-right">{% trans "Total price" %}:</td>
			<td class="a-right">{{ object.get_supp_price_sale|currency }}</td>
		</tr>
		{% endif %}
		{% if object.get_supp_price_rent > 0 %}
		<tr>
			<td style="width:80%;" class="a-right">{% trans "Total annual price" %}:</td>
			<td class="a-right">{{ object.get_supp_price_rent|currency }} / měs.</td>
		</tr>
		{% endif %}
	<tbody>
</table>
{% endif %}
{% endif %}

{% if widget.data == 'work' or widget.data == 'all' %}
{% if object.get_work_price > 0 %}
<h2>{% trans "Work on project" %}</h2>
<table style="width:100%;">
	<thead>
		<tr>
			<th style="width:55%;">{% trans "Work" %}</th>
			<th style="width:15%;" class="a-center">{% trans "Price/hour" %}</th>
			<th style="width:10%;" class="a-center">{% trans "Hours" %}</th>
			<th class="a-right">{% trans "Price" %}</th>
		</tr>
	</thead>
	<tbody>
		{% for feature in object.offerwork_set.all %}
		<tr>
			<td>{{ feature.feature }}</td>
			<td class="a-center">{{ feature.feature.price_sale|currency }}</td>
			<td class="a-center">{{ feature.amount|floatformat:"0" }}</td>
			<td class="a-right">{{ feature.get_price|currency }}</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
<table style="width:100%;">
	<tbody>
		<tr>
			<td style="width:80%;" class="a-right" colspan="3">{% trans "Total price" %}:</td>
			<td class="a-right">{{ object.get_work_price|currency }}</td>
		</tr>
	<tbody>
</table>
{% endif %}
{% endif %}

{% if widget.data == 'all' %}
<h2>{% trans "Price totals" %}</h2>
<table style="width:100%;">
	<thead>
		<tr>
			<th style="width:70%;"></th>
			<th style="width:15%;" class="a-right">{% trans "Price" %}</th>
			<th class="a-right">{% trans "Annual price" %}</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>{% trans "Core features" %}</td>
			<td class="a-right">{{ object.get_core_price_sale|currency }}</td>
			<td class="a-right">{{ object.get_core_price_rent|currency }}</td>
		</tr>
		<tr>
			<td>{% trans "Work on project" %}</td>
			<td class="a-right">{{ object.get_work_price|currency }}</td>
			<td class="a-right">-</td>
		</tr>
	</tbody>
</table>
<table style="width:100%;">
	<tbody>
		<tr>
			<td style="width:70%;" class="a-right"><strong>{% trans "Total price" %}:</strong></td>
			<td style="width:15%;" class="a-right"><strong>{{ object.get_total_price_sale|currency }}</strong></td>
			<td class="a-right"><strong>{{ object.get_total_price_rent|currency }} / měs.</strong></td>
		</tr>
	<tbody>
</table>
{% endif %}

{% endif %}
{% endwith %}
{% endblock %}
