{% extends widget.get_base_template %}

{% load webcms_tags %}
{% load webcms_nav_tags %}

{% block content %}
<ul class="sf-menu">
{% with root.level as level %}
{% feincms_navigation of root as toplevel level=lvl,depth=1 %}
{% for p in toplevel %}
{% if p.active and p.in_navigation %}
{% if p|is_equal_or_parent_of:current %}
<li class="current-cat">
	<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p|get_url }}"><span>{{ p.title }}</span></a>
	{% if depth > 1 %}
	{% feincms_navigation_extended of p as level level=lvl2,depth=1 %}
	{% for p2 in level %}
	{% if forloop.first %}<ul>{% endif %}
	<li>
		<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p2|get_url }}"><span>{{ p2.title }}</span></a>
		{% feincms_navigation_extended of p2 as level2 level=lvl3,depth=1 %}
		{% for p3 in level2 %}
		{% if forloop.first %}<ul>{% endif %}
		<li>
			<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p3|get_url }}"><span>{{ p3.title }}</span></a>
		</li>
		{% if forloop.last %}</ul>{% endif %}
		{% endfor %}
	</li>
	{% if forloop.last %}</ul>{% endif %}
	{% endfor %}
	{% endif %}
</li>
{% else %}
<li>
	<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p|get_url }}"><span>{{ p.title }}</span></a>
	{% if depth > 1 and p.level %}
	{% feincms_navigation_extended of p as level level=lvl2,depth=1 %}
	{% for p2 in level %}
	{% if forloop.first %}<ul>{% endif %}
	<li>
		<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p2|get_url }}"><span>{{ p2.title }}</span></a>
		{% if p2.level %}
		{% feincms_navigation_extended of p2 as level2 level=lvl3,depth=1 %}
		{% for p3 in level2 %}
		{% if forloop.first %}<ul>{% endif %}
		<li>
			<a class="{% if forloop.first %}first {% endif %}{% if forloop.last %}last {% endif %}" href="{{ p3|get_url }}">{{ p3.title }}</a>
		</li>
		{% if forloop.last %}</ul>{% endif %}
		{% endfor %}
		{% endif %}
	</li>
	{% if forloop.last %}</ul>{% endif %}
	{% endfor %}
	{% endif %}
</li>
{% endif %}
{% endif %}
{% endfor %}
{% endwith %}
</ul>
{% if depth > 1 %}
<script type="text/javascript">
$(document).ready(function() {
	$("#{{ widget.fe_identifier }} .sf-menu").superfish();
});
</script>
{% endif %}
{% endblock %}
